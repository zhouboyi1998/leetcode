<h1 style="text-align: center;"> <span style="color: #00AF9B;">196. åˆ é™¤é‡å¤çš„ç”µå­é‚®ç®±</span> </h1>

### ğŸš€ LeetCode

<base target="_blank">

<span style="color: #00AF9B;">**Easy**</span> [**https://leetcode.cn/problems/delete-duplicate-emails/**](https://leetcode.cn/problems/delete-duplicate-emails/)

---

### â“ Description

<br/>

**è¡¨ï¼š** `Person`

```
+-------------+---------+
| Column Name | Type    |
+-------------+---------+
| id          | int     |
| email       | varchar |
+-------------+---------+
id æ˜¯è¯¥è¡¨çš„ä¸»é”®åˆ— (å…·æœ‰å”¯ä¸€å€¼çš„åˆ—).
è¯¥è¡¨çš„æ¯ä¸€è¡ŒåŒ…å«ä¸€å°ç”µå­é‚®ä»¶.
ç”µå­é‚®ä»¶å°†ä¸åŒ…å«å¤§å†™å­—æ¯.
```

<br/>

ç¼–å†™è§£å†³æ–¹æ¡ˆ **åˆ é™¤** æ‰€æœ‰é‡å¤çš„ç”µå­é‚®ä»¶ï¼Œåªä¿ç•™ä¸€ä¸ªå…·æœ‰æœ€å° `id` çš„å”¯ä¸€ç”µå­é‚®ä»¶ã€‚

ï¼ˆå¯¹äº `SQL` ç”¨æˆ·ï¼Œè¯·æ³¨æ„ä½ åº”è¯¥ç¼–å†™ä¸€ä¸ª `DELETE` è¯­å¥è€Œä¸æ˜¯ `SELECT` è¯­å¥ã€‚ï¼‰

ï¼ˆå¯¹äº `Pandas` ç”¨æˆ·ï¼Œè¯·æ³¨æ„ä½ åº”è¯¥ç›´æ¥ä¿®æ”¹ `Person` è¡¨ã€‚ï¼‰

è¿è¡Œè„šæœ¬åï¼Œæ˜¾ç¤ºçš„ç­”æ¡ˆæ˜¯ `Person` è¡¨ã€‚

é©±åŠ¨ç¨‹åºå°†é¦–å…ˆç¼–è¯‘å¹¶è¿è¡Œæ‚¨çš„ä»£ç ç‰‡æ®µï¼Œç„¶åå†æ˜¾ç¤º `Person` è¡¨ã€‚

`Person` è¡¨çš„æœ€ç»ˆé¡ºåº **æ— å…³ç´§è¦** ã€‚

è¿”å›ç»“æœæ ¼å¼å¦‚ä¸‹ç¤ºä¾‹æ‰€ç¤ºã€‚

**ç¤ºä¾‹ 1ï¼š**

```
è¾“å…¥:
Person è¡¨:
+----+------------------+
| id | email            |
+----+------------------+
| 1  | john@example.com |
| 2  | bob@example.com  |
| 3  | john@example.com |
+----+------------------+
è¾“å‡º:
+----+------------------+
| id | email            |
+----+------------------+
| 1  | john@example.com |
| 2  | bob@example.com  |
+----+------------------+
è§£é‡Š: john@example.com é‡å¤ä¸¤æ¬¡, æˆ‘ä»¬ä¿ç•™æœ€å°çš„ Id = 1.
```

<br/>

**SQL Schema**

```
Create table If Not Exists Person (Id int, Email varchar(255));
Truncate table Person;
insert into Person (id, email) values ('1', 'john@example.com');
insert into Person (id, email) values ('2', 'bob@example.com');
insert into Person (id, email) values ('3', 'john@example.com');
```

<br/>

**Pandas Schema**

```
data = [[1, 'john@example.com'], [2, 'bob@example.com'], [3, 'john@example.com']]
person = pd.DataFrame(data, columns=['id', 'email']).astype({'id':'int64', 'email':'object'})
```

---

### â— Solutionï¼ˆ`SELF JOIN` è‡ªè¿æ¥ï¼‰

<br/>

#### MySQL

```
DELETE p1
FROM person AS p1, person AS p2
WHERE p1.email = p2.email
AND p1.id > p2.id;
```

---

### â— Solutionï¼ˆ`ROW_NUMBER()` å‡½æ•°ï¼‰

<br/>

#### MySQL

```
WITH temp AS (
    SELECT id, email,
           ROW_NUMBER() OVER (PARTITION BY email ORDER BY id ASC) AS rn
    FROM person
)
DELETE FROM person
WHERE id NOT IN (
    SELECT id FROM temp WHERE rn = 1
);
```

<br/>

#### PostgreSQL

```
WITH temp AS (
    SELECT id, email,
           ROW_NUMBER() OVER (PARTITION BY email ORDER BY id ASC) AS rn
    FROM person
)
DELETE FROM person
WHERE id NOT IN (
    SELECT id FROM temp WHERE rn = 1
);
```

---

### â— Solutionï¼ˆ`Pandas`ï¼‰

<br/>

#### Python

```
import pandas as pd

def delete_duplicate_emails(person: pd.DataFrame) -> None:
    min_id = person.groupby('email')['id'].transform('min')
    remove_person = person[person['id'] != min_id]
    person.drop(remove_person.index, inplace=True)
    return
```
