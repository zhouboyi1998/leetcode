<h1 style="text-align: center;"> <span style="color: #00AF9B;">1587. é“¶è¡Œè´¦æˆ·æ¦‚è¦ II</span> </h1>

### ğŸš€ LeetCode

<base target="_blank">

<span style="color: #00AF9B;">**Easy**</span> [**https://leetcode.cn/problems/bank-account-summary-ii/**](https://leetcode.cn/problems/bank-account-summary-ii/)

---

### â“ Description

<br/>

**è¡¨ï¼š** `Users`

```
+--------------+---------+
| Column Name  | Type    |
+--------------+---------+
| account      | int     |
| name         | varchar |
+--------------+---------+
account æ˜¯è¯¥è¡¨çš„ä¸»é”®.
è¡¨ä¸­çš„æ¯ä¸€è¡ŒåŒ…å«é“¶è¡Œé‡Œä¸­æ¯ä¸€ä¸ªç”¨æˆ·çš„è´¦å·.
```

**è¡¨ï¼š** `Transactions`

```
+---------------+---------+
| Column Name   | Type    |
+---------------+---------+
| trans_id      | int     |
| account       | int     |
| amount        | int     |
| transacted_on | date    |
+---------------+---------+
trans_id æ˜¯è¯¥è¡¨ä¸»é”®.
è¯¥è¡¨çš„æ¯ä¸€è¡ŒåŒ…å«äº†æ‰€æœ‰è´¦æˆ·çš„äº¤æ˜“æ”¹å˜æƒ…å†µ.
å¦‚æœç”¨æˆ·æ”¶åˆ°äº†é’±, é‚£ä¹ˆé‡‘é¢æ˜¯æ­£çš„; å¦‚æœç”¨æˆ·è½¬äº†é’±, é‚£ä¹ˆé‡‘é¢æ˜¯è´Ÿçš„.
æ‰€æœ‰è´¦æˆ·çš„èµ·å§‹ä½™é¢ä¸º 0.
```

<br/>

å†™ä¸€ä¸ª `SQL` ï¼ŒæŠ¥å‘Šä½™é¢é«˜äº `10000` çš„æ‰€æœ‰ç”¨æˆ·çš„åå­—å’Œä½™é¢ã€‚

è´¦æˆ·çš„ä½™é¢ç­‰äºåŒ…å«è¯¥è´¦æˆ·çš„æ‰€æœ‰äº¤æ˜“çš„æ€»å’Œã€‚

è¿”å›ç»“æœè¡¨å•æ²¡æœ‰é¡ºåºè¦æ±‚ã€‚

æŸ¥è¯¢ç»“æœæ ¼å¼å¦‚ä¸‹ä¾‹æ‰€ç¤ºã€‚

```
Users table:
+------------+--------------+
| account    | name         |
+------------+--------------+
| 900001     | Alice        |
| 900002     | Bob          |
| 900003     | Charlie      |
+------------+--------------+

Transactions table:
+------------+------------+------------+---------------+
| trans_id   | account    | amount     | transacted_on |
+------------+------------+------------+---------------+
| 1          | 900001     | 7000       |  2020-08-01   |
| 2          | 900001     | 7000       |  2020-09-01   |
| 3          | 900001     | -3000      |  2020-09-02   |
| 4          | 900002     | 1000       |  2020-09-12   |
| 5          | 900003     | 6000       |  2020-08-07   |
| 6          | 900003     | 6000       |  2020-09-07   |
| 7          | 900003     | -4000      |  2020-09-11   |
+------------+------------+------------+---------------+

Result table:
+------------+------------+
| name       | balance    |
+------------+------------+
| Alice      | 11000      |
+------------+------------+
Alice çš„ä½™é¢ä¸º(7000 + 7000 - 3000) = 11000.
Bob çš„ä½™é¢ä¸º1000.
Charlie çš„ä½™é¢ä¸º(6000 + 6000 - 4000) = 8000.
```

<br/>

**SQL Schema**

```
Create table If Not Exists Users (account int, name varchar(20));
Create table If Not Exists Transactions (trans_id int, account int, amount int, transacted_on date);
Truncate table Users;
insert into Users (account, name) values ('900001', 'Alice');
insert into Users (account, name) values ('900002', 'Bob');
insert into Users (account, name) values ('900003', 'Charlie');
Truncate table Transactions;
insert into Transactions (trans_id, account, amount, transacted_on) values ('1', '900001', '7000', '2020-08-01');
insert into Transactions (trans_id, account, amount, transacted_on) values ('2', '900001', '7000', '2020-09-01');
insert into Transactions (trans_id, account, amount, transacted_on) values ('3', '900001', '-3000', '2020-09-02');
insert into Transactions (trans_id, account, amount, transacted_on) values ('4', '900002', '1000', '2020-09-12');
insert into Transactions (trans_id, account, amount, transacted_on) values ('5', '900003', '6000', '2020-08-07');
insert into Transactions (trans_id, account, amount, transacted_on) values ('6', '900003', '6000', '2020-09-07');
insert into Transactions (trans_id, account, amount, transacted_on) values ('7', '900003', '-4000', '2020-09-11');
```

---

### â— Solution

<br/>

#### MySQL

```
SELECT u.name, SUM(t.amount) AS balance
FROM users AS u
LEFT JOIN transactions AS t ON t.account = u.account
GROUP BY t.account
HAVING balance > 10000;
```
